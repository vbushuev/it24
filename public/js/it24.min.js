var $jscomp={scope:{},findInternal:function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var g=a[e];if(b.call(c,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
var getKeys=function(a,b){var c,d=[];for(c in a)b&&!b.test(c)||!a.hasOwnProperty(c)||(d[d.length]=c);return d},priceNumber=function(a){var b=null==a?0:a,c=b.toString().split(/\./),d="";if(1E3<=a){a=c[0].split("").reverse();var b=3,e;for(e in a)d+=a[e],0>=--b&&(d+=" ",b=3);b=d.split("").reverse().join("")+"."+c[1]}return b+"&#8381;"},periodTranslate=function(a){switch(a){case 1440:case "1440":a="\u0420\u0430\u0437 \u0432 \u0434\u0435\u043d\u044c";break;case 240:case "240":a="\u041a\u0430\u0436\u0434\u044b\u0435 4 \u0447\u0430\u0441\u0430";
break;case 120:case "120":a="\u041a\u0430\u0436\u0434\u044b\u0435 2 \u0447\u0430\u0441\u0430";break;case 60:case "60":a="\u041a\u0430\u0436\u0434\u044b\u0439 \u0447\u0430\u0441";break;case 30:case "30":a="\u041a\u0430\u0436\u0434\u044b\u0435 \u043f\u043e\u043b\u0447\u0430\u0441\u0430"}return a},barcodeDraw=function(a){if("0"==a||0==a)return"";var b={},c="",d=a.split(""),e="";b["0"]="bwbwwwbbbwbbbwbw";b["1"]="bbbwbwwwbwbwbbbw";b["2"]="bwbbbwwwbwbwbbbw";b["3"]="bbbwbbbwwwbwbwbw";b["4"]="bwbwwwbbbwbwbbbw";
b["5"]="bbbwbwwwbbbwbwbw";b["6"]="bwbbbwwwbbbwbwbw";b["7"]="bwbwwwbwbbbwbbbw";b["8"]="bbbwbwwwbwbbbwbw";b["9"]="bwbbbwwwbwbbbwbw";b.A="bbbwbwbwwwbwbbbw";b.B="bwbbbwbwwwbwbbbw";b.C="bbbwbbbwbwwwbwbw";b.D="bwbwbbbwwwbwbbbw";b.E="bbbwbwbbbwwwbwbw";b.F="bwbbbwbbbwwwbwbw";b.G="bwbwbwwwbbbwbbbw";b.H="bbbwbwbwwwbbbwbw";b.I="bwbbbwbwwwbbbwbw";b.J="bwbwbbbwwwbbbwbw";b.K="bbbwbwbwbwwwbbbw";b.L="bwbbbwbwbwwwbbbw";b.M="bbbwbbbwbwbwwwbw";b.N="bwbwbbbwbwwwbbbw";b.O="bbbwbwbbbwbwwwbw";b.P="bwbbbwbbbwbwwwbw";b.Q=
"bwbwbwbbbwwwbbbw";b.R="bbbwbwbwbbbwwwbw";b.S="bwbbbwbwbbbwwwbw";b.T="bwbwbbbwbbbwwwbw";b.U="bbbwwwbwbwbwbbbw";b.V="bwwwbbbwbwbwbbbw";b.W="bbbwwwbbbwbwbwbw";b.X="bwwwbwbbbwbwbbbw";b.Y="bbbwwwbwbbbwbwbw";b.Z="bwwwbbbwbbbwbwbw";b["-"]="bwwwbwbwbbbwbbbw";b["."]="bbbwwwbwbwbbbwbw";b[" "]="bwwwbbbwbwbbbwbw";b["*"]="bwwwbwbbbwbbbwbw";b.$="bwwwbwwwbwwwbwbw";b["/"]="bwwwbwwwbwbwwwbw";b["+"]="bwwwbwbwwwbwwwbw";b["%"]="bwbwwwbwwwbwwwbw";for(var g in d)e+=b[d[g]];console.debug(a+" => "+e);bc_c=e.split("");for(g in bc_c)"b"==
bc_c[g]&&(c+='<line x1="'+1*g+'" y1="0" x2="'+1*g+'" y2="48" style="stroke:rgb(0,0,0);stroke-width:1" />'),0==g%16&&(c+='<text x="'+(6+g/16*16)+'" y="64" fill="black">'+d[g/16]+"</text>");return c='<svg height="80" width="'+16*d.length+'">'+c+"</svg>"},expander=function(a){a=$(a);var b=a.next(a.attr("data-rel")+":first"),c=a.find("i.fa");a.hasClass("expander-expanded")?(a.removeClass("expander-expanded"),c.removeClass("fa-caret-up").addClass("fa-caret-down"),b.slideUp()):(a.addClass("expander-expanded"),
c.removeClass("fa-caret-down").addClass("fa-caret-up"),b.slideDown());return!1},page={noscroll:!1,filters:{data:{f:0,l:24,s:"",brand_id:"",supply_id:"",parent_id:"",catalog_id:[]},search:function(a){a=a.val();3<a.length&&(page.filters.data.f=0,page.filters.data.s=a,page.load())},searchName:function(a){a=a.val();3<a.length&&(page.filters.data.f=0,page.filters.data.n=a,page.load())},clear:function(){var a=arguments.length?Array.isArray(arguments[0])?arguments[0]:[arguments[0]]:[];if(a.length)for(var b in a)"catalog_id"==
a[b]?($(".filter-check").removeAttr("checked"),this.data[a[b]]=[]):this.data[a[b]]="";else for(a in this.data)this.data[a]="";this.data.f=0;this.data.l=24;page.load()},filter:{brands:function(){filters.data.f=0;filters.data.brand_id=arguments.length?arguments[0]:"";page.load()},error:function(){page.filters.data.f=0;page.filters.data.error=1==page.filters.data.error?0:1;page.load()},catalogs:function(){var a=arguments.length?arguments[0]:"",b="undefined"!=typeof $(a).attr("checked");page.filters.data.catalog_id=
"undefined"==typeof page.filters.data.catalog_id?[]:page.filters.data.catalog_id;Array.isArray(page.filters.data.catalog_id)||(page.filters.data.catalog_id=[]);b?($(a).removeAttr("checked"),delete page.filters.data.catalog_id[$(a).parent().attr("data-id")],page.filters.data.catalog_id.splice(page.filters.data.catalog_id.indexOf($(a).parent().attr("data-id")),1)):($(a).attr("checked","checked"),page.filters.data.catalog_id.push($(a).parent().attr("data-id")));$(a).parent().find("ul.dropdown-menu li").each(function(){b?
(page.filters.data.catalog_id.splice(page.filters.data.catalog_id.indexOf($(this).attr("data-id")),1),$(this).find(".filter-check").removeAttr("checked")):(page.filters.data.catalog_id.push($(this).attr("data-id")),$(this).find(".filter-check").attr("checked","checked"))});console.debug(page.filters.data.catalog_id);page.filters.data.f=0;page.load()}},get:{all:function(){page.filters.get.roles();page.filters.get.brands();page.filters.get.suppliers();page.filters.get.catalogs();console.debug("#jscontent trigger it24:filters-loaded");
$("#jscontent").trigger("it24:filters-loaded")},roles:function(){var a=$(".roles").next("ul.dropdown-menu"),b=$(".role").next("ul.dropdown-menu");0==a.length&&0==b.length||$.ajax({url:"/data/roles",type:"GET",dataType:"json",success:function(c){for(var d=0;d<c.length;++d){var e=c[d];store.roles[e.code]=e.title;a.append("<li><a href=\"javascript:{page.filters.data.f=0;page.filters.data.role='"+e.code+"';page.load();}\">"+(e.title.length?e.title:"noname")+"</a></li>");b.append("<li><a href=\"javascript:{$('input[name=role]').val('"+
e.code+"');$('input[name=roleName]').val('"+e.title+"');}\">"+(e.title.length?e.title:"noname")+"</a></li>")}}})},brands:function(a){var b=$(".brands").next("ul.dropdown-menu");0!=b.length&&$.ajax({url:"/data/brands",type:"GET",dataType:"json",success:function(a){for(var c=0;c<a.length;++c){var e=a[c];b.append('<li><a href="javascript:{page.filters.data.f=0;page.filters.data.brand_id='+e.id+';page.load();}">'+(e.title.length?e.title:"noname")+"</a></li>")}}})},suppliers:function(a){var b=$(".suppliers").next("ul.dropdown-menu");
0!=b.length&&$.ajax({url:"/data/suppliers",type:"GET",dataType:"json",success:function(a){for(var c=0;c<a.length;++c){var e=a[c];b.append('<li><a href="javascript:{page.filters.data.f=0;page.filters.data.supply_id='+e.id+';page.load();}">'+e.title+"</a></li>")}}})},catalogs:function(a){var b=$(".catalogs").next("ul.dropdown-menu"),c=function(a){var b="",d;for(d in a){var f=a[d];store.catalogs[f.id]=f.title;b+='<li data-id="'+f.id+'" class="catalog-id'+(Array.isArray(f.childs)?"":" dropdown-submenu")+
'">';b+='<input class="filter-check" type="checkbox" onchange="{page.filters.filter.catalogs(this);}"/>';b+='<a href="javascript:0" data-id="'+f.id+'" id="'+f.id+'" class="submenu'+(Array.isArray(f.childs)?"":' dropdown-toggle" data-toggle="dropdown" aria-expanded="false')+'">'+f.title+"</a>";Array.isArray(f.childs)||(b+='<ul class="dropdown-menu">',b+=c(f.childs),b+="</ul>");b+="</li>"}return b};0!=b.length&&$.ajax({url:"/data/catalogs",type:"GET",dataType:"json",success:function(a){store.catalogs=
{};for(var e in a){var d=a[e],f="";store.catalogs[d.id]=d.title;f+='<li data-id="'+d.id+'" '+(Array.isArray(d.childs)?"":'class="dropdown-submenu"')+">";f+='<input class="filter-check" type="checkbox" onchange="{page.filters.filter.catalogs(this);}"/>';f+='<a href="javascript:0" data-id="'+d.id+'" id="'+d.id+'" class="catalogs submenu'+(Array.isArray(d.childs)?"":' dropdown-toggle" data-toggle="dropdown" aria-expanded="false')+'">'+d.title+"</a>";Array.isArray(d.childs)||(f+='<ul class="dropdown-menu">',
f+=c(d.childs),f+="</ul>");f+="</li>";b.append(f)}}})}}},refresh:function(){page.filters.clear();page.load()},reload:function(){page.filters.data.f-=page.filters.data.l;page.filters.data.f=page.filters.data.f<page.filters.data.l?0:page.filters.data.f;page.load()},loading:!1,load:function(){var a=arguments.length?arguments[0]:".js-container, #js-container";console.debug("what = "+a);$(a).each(function(){var a=$(this);console.debug("loading page with data from "+a.attr("data-ref"));$.ajax({url:a.attr("data-ref"),
type:"GET",data:page.filters.data,dataType:"json",beforeSend:function(){page.loading=!0;page.filters.data.f||$(this).html("")},success:function(b){var c=a.attr("data-func");console.debug(typeof window[c]+" "+typeof _contentLoader);if("function"==typeof window[c])window[c](b);else"undefined"!=typeof _contentLoader&&_contentLoader(b)},complete:function(){page.loading=!1;$(document).trigger("page:loaded")}})})},submit:function(){if(arguments.length){var a=arguments[0],b={};$(a.form+" input:not(.no-request)").each(function(){var a=
$(this).val();b[$(this).attr("name")]=a});console.debug(b);$.ajax({url:$(a.form).attr("data-rel"),dataType:"json",data:b,success:function(b){console.debug(b);$(a.form).modal("hide");document.location.reload()}})}}},store={roles:{},catalogs:null};$(document).ready(function(){page.filters.get.all();$(window).scroll(function(){page.noscroll||$(window).height()+$(window).scrollTop()+300>=$(document).height()&&page.load()});page.load();$("#jscontent").on("it24:filters-loaded",function(){})});
